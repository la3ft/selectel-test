---
- name: Install GO
  ansible.builtin.apt:
    name: golang-go

- name: Clone
  ansible.builtin.git:
    repo: https://github.com/dropbox/llama
    dest: ./llama

- name: Build
  shell:  |
    cd llama
    GOOS=linux GOARCH=amd64 go build -o scraper cmd/scraper/main.go

- name: Install
  shell:  |
    cd llama
    mv scraper /bin

- name: Create scraper daemon
  template: src=scraper.service.j2 dest=/lib/systemd/system/scraper.service mode=644

- name: Start scraper service
  systemd:
    name: scraper
    state: started